#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""Extract and print information from an APK file."""

import argparse
import sys

import simplejson as json

from servalx import apk as Apk
from servalx import extractions

PARSER = argparse.ArgumentParser(description=__doc__)
PARSER.add_argument('apkfile', type=argparse.FileType('r'))


def apkinfos(apkfile):
    apk = Apk.APK(apkfile.read())

    return extractions.apk(apk)


if __name__ == '__main__':
    args = PARSER.parse_args()

    infos = apkinfos(args.apkfile)

    json.dump(infos, sys.stdout)
